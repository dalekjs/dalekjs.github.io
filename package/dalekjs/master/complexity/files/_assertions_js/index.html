<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title></title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet">
  <link href="../../assets/css/vendor/font-awesome-ie7.css" rel="stylesheet">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet">
  <link href="../../assets/css/plato.css" rel="stylesheet">
  <link href="../../assets/css/plato-file.css" rel="stylesheet">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="http://github.com/jsoverson/plato">Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>/assertions.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"></i></a></h2>
      <p class="stat">67.09</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC"></i></h2>
      <p class="stat">1726</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty"></i></a></h2>
      <p class="stat">99.68</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs"></i></a></h2>
      <p class="stat">8.17</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">/*!
 *
 * Copyright (c) 2013 Sebastian Golasch
 *
 * Permission is hereby granted, free of charge, to any person obtaining a
 * copy of this software and associated documentation files (the &quot;Software&quot;),
 * to deal in the Software without restriction, including without limitation
 * the rights to use, copy, modify, merge, publish, distribute, sublicense,
 * and/or sell copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included
 * in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS
 * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
 * DEALINGS IN THE SOFTWARE.
 */

&#039;use strict&#039;;

// ext. libs
var Q = require(&#039;q&#039;);
var uuid = require(&#039;node-uuid&#039;);
var chai = require(&#039;chai&#039;);

// Module variable
var Assertions;

/**
 * @module Assertions
 * @namespace Dalek.Internal
 */

module.exports = function () {
  return Assertions;
};

/**
 * Assertions check if the assumptions you made about a website are correct.
 * For example they might check if the title of a page or the content text of
 * an element is as expected, or if your mobile website version only displays
 * a certain amount of elements.
 *
 * @class Assertions
 * @constructor
 * @part Assertions
 * @api
 */

Assertions = function (opts) {
  this.test = opts.test;
  this.proceeded = [];
  this.chaining = false;
};

/**
 * It can be really cumbersome to always write assert, assert &amp; assert
 * all over the place when your doing multiple assertions.
 * To avoid this, open an assertion context in your test which allows
 * you to write (n) assertions without having to write &#039;assert&#039; before each.
 *
 * So, instead of writing this:
 *
 * ```javascript
 * test.open(&#039;http://doctorwhotv.co.uk/&#039;)
 *     .assert.text(&#039;#nav&#039;).is(&#039;Navigation&#039;)
 *     .assert.visible(&#039;#nav&#039;)
 *     .assert.attr(&#039;#nav&#039;, &#039;data-nav&#039;, &#039;true&#039;)
 *     .done();
 * ```
 *
 * you can write this:
 *
 * ```javascript
 * test.open(&#039;http://doctorwhotv.co.uk/&#039;)
 *     .assert.chain()
 *       .text(&#039;#nav&#039;).is(&#039;Navigation&#039;)
 *       .visible(&#039;#nav&#039;)
 *       .attr(&#039;#nav&#039;, &#039;data-nav&#039;, &#039;true&#039;)
 *     .end()
 *     .done();
 * ```
 *
 * to make it even more concise, you can combine this with the [query](actions.html#meth-query) method:
 *
 * ```javascript
 * test.open(&#039;http://doctorwhotv.co.uk/&#039;)
 *     .assert.chain()
 *       .query(&#039;#nav&#039;)
 *           .text().is(&#039;Navigation&#039;)
 *           .visible()
 *           .attr(&#039;data-nav&#039;, &#039;true&#039;)
 *         .end()
 *     .end()
 *     .done();
 * ```
 *
 * Always make sure, you terminate it with the [end](#meth-end) method!
 *
 * @api
 * @method chain
 * @chainable
 */

Assertions.prototype.chain = function () {
  this.test.lastChain.push(&#039;chaining&#039;);
  this.chaining = true;
  return this;
};

/**
 * Terminates an assertion chain or a query
 *
 * ```javascript
 * test.open(&#039;http://doctorwhotv.co.uk/&#039;)
 *     .assert.chain()
 *       .query(&#039;#nav&#039;)
 *           .text().is(&#039;Navigation&#039;)
 *           .visible()
 *           .attr(&#039;data-nav&#039;, &#039;true&#039;)
 *         .end()
 *     .end()
 *     .done();
 * ```
 *
 * @api
 * @method end
 * @chainable
 */

Assertions.prototype.end = function () {
  var lastAction = this.test.lastChain.pop();
  if (lastAction === &#039;chaining&#039;) {
    this.chaining = false;
  }

  if (lastAction  === &#039;querying&#039;) {
    this.test.querying = false;
  }
  return this.test;
};

/**
 * Asserts that a given resource does exist in the environment.
 *
 * @method resourceExists
 * @param {string} url URL of the resource to check
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.resourceExists = function (url, message) {
  var hash = uuid.v4();
  var cb = this._generateCallbackAssertion(&#039;resourceExists&#039;, &#039;resourceExists&#039;, this._testTruthy, hash, {url: url, message: message}).bind(this.test);
  this._addToActionQueue([url, hash], &#039;resourceExists&#039;, cb);
  return this.chaining ? this : this.test;
};

/**
 * Asserts that a given element appears n times on the page.
 *
 * Given this portion of HTML, you would like to assure that all of these elements
 * are ending up in your rendered markup on your page.
 *
 * ```html
 * &lt;section id=&quot;blog-overview&quot;&gt;
 *   &lt;article class=&quot;teaser&quot;&gt;&lt;/article&gt;
 *   &lt;article class=&quot;teaser&quot;&gt;&lt;/article&gt;
 *   &lt;article class=&quot;teaser&quot;&gt;&lt;/article&gt;
 *   &lt;article class=&quot;teaser&quot;&gt;&lt;/article&gt;
 * &lt;/section&gt;
 * ```
 *
 * The simple solution is to check if all these elements are present
 *
 * ```javascript
 * test.assert.numberOfElements(&#039;#blog-overview .teaser&#039;, 4, &#039;4 blog teasers are present&#039;)
 * ```
 * The alternate syntax for this is:
 *
 * ```javascript
 * test.assert.numberOfElements(&#039;#blog-overview .teaser&#039;)
 *     .is(4, &#039;4 blog teasers are present&#039;)
 * ```
 *
 * If you are not sure how many elements will exactly end up in your markup,
 * you could use the between assertion handler
 *
 * ```javascript
 * test.assert.numberOfElements(&#039;#blog-overview .teaser&#039;)
 *     .is.between([2, 6], &#039;Between 2 and 6 blog teasers are present&#039;)
 * ```
 *
 * If you dealing with the situation that you have a minimum of elements,
 * you expect, you can use this helper:
 *
 * ```javascript
 * test.assert.numberOfElements(&#039;#blog-overview .teaser&#039;)
 *     .is.gt(2, &#039;At least 3 blog teasers are present&#039;)
 * ```
 * If you want to know if its &#039;greater than equal&#039;, use this one
 *
 * ```javascript
 * test.assert.numberOfElements(&#039;#blog-overview .teaser&#039;)
 *     .is.gte(2, &#039;At least 2 blog teasers are present&#039;)
 * ```
 * as well as their &#039;lower than&#039; and &#039;lower than equal&#039; equivalents.
 *
 * ```javascript
 * test.assert.numberOfElements(&#039;#blog-overview .teaser&#039;)
 *     .is.lt(5, &#039;Less than 5 blog teasers are present&#039;)
 * ```
 *
 * ```javascript
 * test.assert.numberOfElements(&#039;#blog-overview .teaser&#039;)
 *     .is.lte(5, &#039;Less than, or 5 blog teasers are present&#039;)
 * ```
 * And if you just want to know, if a certain amount of teasers isnʼt present,
 * you can still use the not() assertion helper
 *
 * ```javascript
 * test.assert.numberOfElements(&#039;#blog-overview .teaser&#039;)
 *     .is.not(5, &#039;There are more or less than 5 teasers present&#039;)
 * ```
 *
 * @api
 * @method numberOfElements
 * @param {string} selector Selector that matches the elements to test
 * @param {string} expected Expected test result
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.numberOfElements = function (selector, expected, message) {
  var hash = uuid.v4();

  if (this.test.querying === true) {
    message = expected;
    expected = selector;
    selector = this.test.selector;
  }

  var cb = this._generateCallbackAssertion(&#039;numberOfElements&#039;, &#039;numberOfElements&#039;, this._testShallowEquals, hash, {expected: expected, selector: selector, message: message}).bind(this.test);
  this._addToActionQueue([selector, expected, hash], &#039;getNumberOfElements&#039;, cb);
  return this.chaining ? this : this.test;
};

/**
 *
 * Asserts that a given element is visible n times in the current viewport.
 *
 *
 * Given this portion of HTML, you would like to assure that all of these elements
 * are ending up in your rendered markup on your page.
 *
 * ```html
 * &lt;section id=&quot;blog-overview&quot;&gt;
 *   &lt;article class=&quot;teaser&quot;&gt;&lt;/article&gt;
 *   &lt;article class=&quot;teaser&quot;&gt;&lt;/article&gt;
 *   &lt;article class=&quot;teaser&quot;&gt;&lt;/article&gt;
 *   &lt;article class=&quot;teaser&quot;&gt;&lt;/article&gt;
 * &lt;/section&gt;
 * ```
 *
 * The simple solution is to check if all these elements are visible
 *
 * ```javascript
 * test.assert.numberOfVisibleElements(&#039;#blog-overview .teaser&#039;, 4, &#039;4 blog teasers are visible&#039;)
 * ```
 * The alternate syntax for this is:
 *
 * ```javascript
 * test.assert.numberOfVisibleElements(&#039;#blog-overview .teaser&#039;)
 *     .is(4, &#039;4 blog teasers are visible&#039;)
 * ```
 *
 * If you are not sure how many elements will exactly be shown in the current viewport,
 * you could use the between assertion handler
 *
 * ```javascript
 * test.assert.numberOfVisibleElements(&#039;#blog-overview .teaser&#039;)
 *     .is.between(2, 6, &#039;Between 2 and 6 blog teasers are visible&#039;)
 * ```
 *
 * If you dealing with the situation that you have a minimum of elements,
 * you expect, use this helper:
 *
 * ```javascript
 * test.assert.numberOfVisibleElements(&#039;#blog-overview .teaser&#039;)
 *     .is.gt(2, &#039;At least 3 blog teasers are visible&#039;)
 * ```
 * If you want to know if its &#039;greater than equal&#039;, you can use this one
 *
 * ```javascript
 * test.assert.numberOfVisibleElements(&#039;#blog-overview .teaser&#039;)
 *     .is.gte(2, &#039;At least 2 blog teasers are visible&#039;)
 * ```
 * as well as their &#039;lower than&#039; and &#039;lower than equal&#039; equivalents.
 *
 * ```javascript
 * test.assert.numberOfVisibleElements(&#039;#blog-overview .teaser&#039;)
 *     .is.lt(5, &#039;Less than 5 blog teasers are visible&#039;)
 * ```
 *
 * ```javascript
 * test.assert.numberOfVisibleElements(&#039;#blog-overview .teaser&#039;)
 *     .is.lte(5, &#039;Less than, or 5 blog teasers are visible&#039;)
 * ```
 * And if you just want to know, if a certain amount of teasers isnʼt visible,
 * you can still use the &#039;:not(): assertion helper
 *
 * ```javascript
 * test.assert.numberOfVisibleElements(&#039;#blog-overview .teaser&#039;)
 *     .is.not(5, &#039;There are more or less than 5 teasers visible&#039;)
 * ```
 *
 * &gt; NOTE: Buggy on all browsers
 * 
 * @api
 * @method numberOfVisibleElements
 * @param {string} selector Selector that matches the elements to test
 * @param {string} expected Expected test result
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.numberOfVisibleElements = function (selector, expected, message) {
  var hash = uuid.v4();

  if (this.test.querying === true) {
    message = expected;
    expected = selector;
    selector = this.test.selector;
  }

  var cb = this._generateCallbackAssertion(&#039;numberOfVisibleElements&#039;, &#039;numberOfVisibleElements&#039;, this._testShallowEquals, hash, {expected: expected, selector: selector, message: message}).bind(this.test);
  this._addToActionQueue([selector, expected, hash], &#039;getNumberOfVisibleElements&#039;, cb);
  return this.chaining ? this : this.test;
};

/**
 * Asserts that a given form field has the provided value.
 *
 * Given this portion of HTML, we would like to get the information which option element
 * is currently selected.
 *
 * ```html
 * &lt;form name=&quot;fav-doctor&quot; id=&quot;fav-doctor&quot;&gt;
 *   &lt;select id=&quot;the-doctors&quot;&gt;
 *     &lt;option value=&quot;9&quot;&gt;Eccleston&lt;/option&gt;
 *     &lt;option selected value=&quot;10&quot;&gt;Tennant&lt;/option&gt;
 *     &lt;option value=&quot;11&quot;&gt;Smith&lt;/option&gt;
 *   &lt;/select&gt;
 * &lt;/form&gt;
 * ```
 *
 * ```javascript
 * test
 *   .assert.val(&#039;#the-doctors&#039;, 10, &#039;David is the favourite&#039;)
 *   // lets change the favourite by selection the last option
 *  .click(&#039;#the-doctors option:last&#039;)
 *  .assert.val(&#039;#the-doctors&#039;, 11, &#039;Matt is now my favourite, bow ties are cool&#039;)
 * ```
 *
 * This assertion is capable of getting the values from every form element
 * that holds a value attribute
 *
 * Getting texts out of normal input fields is pretty straight forward
 *
 * ```html
 * &lt;label for=&quot;fav-enemy&quot;&gt;Tell my your favourity Who enemy:&lt;/label&gt;
 * &lt;input id=&quot;fav-enemy&quot; name=&quot;fav-enemy&quot; type=&quot;text&quot; value=&quot;Daleks&quot; /&gt;
 * ```
 *
 * ```javascript
 * test
 *   .assert.val(&#039;#fav-enemy&#039;, &#039;Daleks&#039;, &#039;Daleks are so cute&#039;)
 *   // lets change the favourite by typing smth. new
 *  .type(&#039;#fav-enemy&#039;, &#039;Cyberman&#039;)
 *  .assert.val(&#039;#fav-enemy&#039;, &#039;Cyberman&#039;, &#039;Cyberman are so cyber&#039;)
 * ```
 *
 * @api
 * @method val
 * @param {string} selector Selector that matches the elements to test
 * @param {string} expected Expected test result
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.val = function (selector, expected, message) {
  var hash = uuid.v4();

  if (this.test.querying === true) {
    message = expected;
    expected = selector;
    selector = this.test.selector;
  }

  var cb = this._generateCallbackAssertion(&#039;val&#039;, &#039;val&#039;, this._testShallowEquals, hash, {expected: expected, selector: selector, message: message}).bind(this.test);
  this._addToActionQueue([selector, expected, hash], &#039;val&#039;, cb);
  return this.chaining ? this : this.test;
};

/**
 * Checks the computed style.
 *
 * ```html
 * &lt;div id=&quot;superColoredElement&quot;&gt;Rose&lt;/div&gt;
 * ```
 *
 * ```css
 * #superColoredElement {
 *   background-color: rgba(255, 0, 0, 1);
 *   color: rgba(0, 128, 0, 1);
 * }
 * ```
 *
 * ```javascript
 *  test
 *    .open(&#039;http://unicorns.rainbows.io&#039;)
 *    .assert.css(&#039;#superColoredElement&#039;, &#039;background-color&#039;, &#039;rgba(255, 0, 0, 1)&#039;)
 *    .assert.css(&#039;#superColoredElement&#039;, &#039;color&#039;, &#039;rgba(0, 128, 0, 1)&#039;)
 *    .done();
 * ```
 *
 * @api
 * @method css
 * @param {string} selector Selector that matches the elements to test
 * @param {string} property CSS property to check
 * @param {string} expected Expected test result
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.css = function (selector, property, expected, message) {
  var hash = uuid.v4();

  if (this.test.querying === true) {
    message = expected;
    expected = property;
    property = selector;
    selector = this.test.selector;
  }

  var cb = this._generateCallbackAssertion(&#039;css&#039;, &#039;css&#039;, this._testShallowEquals, hash, {expected: expected, selector: selector, porperty: property, message: message}).bind(this.test);
  this._addToActionQueue([selector, property, expected, hash], &#039;css&#039;, cb);
  return this.chaining ? this : this.test;
};

/**
 * Checks the actual width of an element.
 *
 * ```html
 *   &lt;div id=&quot;fixed-dimensions&quot; style=&quot;width: 100px&quot;&gt;&lt;/div&gt;
 * ```
 *
 * ```javascript
 *  test
 *    .open(&#039;http://localhost:5000/index.html&#039;)
 *    // all true, all pixel
 *    .assert.width(&#039;#fixed-dimensions&#039;, 100)
 *    .assert.width(&#039;#fixed-dimensions&#039;).is(100)
 *    .assert.width(&#039;#fixed-dimensions&#039;).is.not(100)
 *    .assert.width(&#039;#fixed-dimensions&#039;).is.gt(90)
 *    .assert.width(&#039;#fixed-dimensions&#039;).is.gte(97)
 *    .assert.width(&#039;#fixed-dimensions&#039;).is.lt(120)
 *    .assert.width(&#039;#fixed-dimensions&#039;).is.lte(110)
 *    .assert.width(&#039;#fixed-dimensions&#039;).is.between([90, 110])
 *    .done();
 *
 * ```
 *
 * @api
 * @method width
 * @param {string} selector Selector that matches the elements to test
 * @param {string} expected Expected test result
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.width = function (selector, expected, message) {
  var hash = uuid.v4();

  if (this.test.querying === true) {
    message = expected;
    expected = selector;
    selector = this.test.selector;
  }

  var cb = this._generateCallbackAssertion(&#039;width&#039;, &#039;width&#039;, this._testShallowEquals, hash, {expected: expected, selector: selector, message: message}).bind(this.test);
  this._addToActionQueue([selector, expected, hash], &#039;width&#039;, cb);
  return this.chaining ? this : this.test;
};

/**
 * Checks the actual height of an element.
 *
 * ```html
 *   &lt;div id=&quot;fixed-dimensions&quot; style=&quot;height: 100px&quot;&gt;&lt;/div&gt;
 * ```
 *
 * ```javascript
 *  test
 *    .open(&#039;http://localhost:5000/index.html&#039;)
 *    // all true, all pixel
 *    .assert.height(&#039;#fixed-dimensions&#039;, 100)
 *    .assert.height(&#039;#fixed-dimensions&#039;).is(100)
 *    .assert.height(&#039;#fixed-dimensions&#039;).is.not(100)
 *    .assert.height(&#039;#fixed-dimensions&#039;).is.gt(90)
 *    .assert.height(&#039;#fixed-dimensions&#039;).is.gte(97)
 *    .assert.height(&#039;#fixed-dimensions&#039;).is.lt(120)
 *    .assert.height(&#039;#fixed-dimensions&#039;).is.lte(110)
 *    .assert.height(&#039;#fixed-dimensions&#039;).is.between([90, 110])
 *    .done();
 *
 * ```
 *
 * @api
 * @method height
 * @param {string} selector Selector that matches the elements to test
 * @param {string} expected Expected test result
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.height = function (selector, expected, message) {
  var hash = uuid.v4();

  if (this.test.querying === true) {
    message = expected;
    expected = selector;
    selector = this.test.selector;
  }

  var cb = this._generateCallbackAssertion(&#039;height&#039;, &#039;height&#039;, this._testShallowEquals, hash, {expected: expected, selector: selector, message: message}).bind(this.test);
  this._addToActionQueue([selector, expected, hash], &#039;height&#039;, cb);
  return this.chaining ? this : this.test;
};

/**
 * Determine if an &lt;option&gt; element, or an &lt;input&gt; element of type checkbox or radio is currently selected.
 *
 * ```html
 * &lt;input type=&quot;checkbox&quot; id=&quot;unchecked_checkbox&quot; name=&quot;unchecked_checkbox&quot;/&gt;
 * &lt;input type=&quot;checkbox&quot; id=&quot;checked_checkbox&quot; name=&quot;checked_checkbox&quot; checked=&quot;checked&quot;/&gt;
 * &lt;select id=&quot;select_elm&quot; name=&quot;select_elm&quot;&gt;
 *   &lt;option value=&quot;9&quot;&gt;Eccleston&lt;/option&gt;
 *   &lt;option selected value=&quot;10&quot;&gt;Tennant&lt;/option&gt;
 *   &lt;option value=&quot;11&quot;&gt;Smith&lt;/option&gt;
 * &lt;/select&gt;
 * ```
 *
 * Checking radio and checkboxes:
 *
 * ```javascript
 *  test
 *    .open(&#039;http://selectables.org&#039;)
 *    .assert.selected(&#039;#checked_checkbox&#039;)
 *    .done();
 * ```
 *
 * Checking option elements:
 *
 * ```javascript
 *  test
 *    .open(&#039;http://selectables.org&#039;)
 *    .assert.selected(&#039;#select_elm option:nth-child(2)&#039;)
 *    .done();
 * ```
 *
 * @api
 * @method selected
 * @param {string} selector Selector that matches the elements to test
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.selected = function (selector, message) {
  var hash = uuid.v4();

  if (this.test.querying === true) {
    message = selector;
    selector = this.test.selector;
  }

  var cb = this._generateCallbackAssertion(&#039;selected&#039;, &#039;selected&#039;, this._testShallowEquals, hash, {expected: true, selector: selector, message: message}).bind(this.test);
  this._addToActionQueue([selector, true, hash], &#039;selected&#039;, cb);
  return this.chaining ? this : this.test;
};

/**
 * Determine if an &lt;option&gt; element, or an &lt;input&gt; element of type
 * checkbox or radio is currently not selected.
 *
 * ```html
 * &lt;input type=&quot;checkbox&quot; id=&quot;unchecked_checkbox&quot; name=&quot;unchecked_checkbox&quot;/&gt;
 * &lt;input type=&quot;checkbox&quot; id=&quot;checked_checkbox&quot; name=&quot;checked_checkbox&quot; checked=&quot;checked&quot;/&gt;
 * &lt;select id=&quot;select_elm&quot; name=&quot;select_elm&quot;&gt;
 *   &lt;option value=&quot;9&quot;&gt;Eccleston&lt;/option&gt;
 *   &lt;option selected value=&quot;10&quot;&gt;Tennant&lt;/option&gt;
 *   &lt;option value=&quot;11&quot;&gt;Smith&lt;/option&gt;
 * &lt;/select&gt;
 * ```
 *
 * Checking radio and checkboxes:
 *
 * ```javascript
 *  test
 *    .open(&#039;http://selectables.org&#039;)
 *    .assert.notSelected(&#039;#unchecked_checkbox&#039;)
 *    .done();
 * ```
 *
 * Checking option elements:
 *
 * ```javascript
 *  test
 *    .open(&#039;http://selectables.org&#039;)
 *    .assert.notSelected(&#039;#select_elm option:last-child&#039;)
 *    .done();
 * ```
 *
 * @api
 * @method notSelected
 * @param {string} selector Selector that matches the elements to test
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.notSelected = function (selector, message) {
  var hash = uuid.v4();

  if (this.test.querying === true) {
    message = selector;
    selector = this.test.selector;
  }

  var cb = this._generateCallbackAssertion(&#039;selected&#039;, &#039;selected&#039;, this._testShallowEquals, hash, {expected: false, selector: selector, message: message}).bind(this.test);
  this._addToActionQueue([selector, false, hash], &#039;selected&#039;, cb);
  return this.chaining ? this : this.test;
};

/**
 * Determine if an element is currently enabled.
 *
 * ```html
 * &lt;input id=&quot;onmars&quot; type=&quot;text&quot; size=&quot;50&quot; name=&quot;onmars&quot; placeholder=&quot;State your name, rank and intention!&quot;&gt;&lt;/input&gt;
 * ```
 *
 * ```javascript
 * test
 *   .open(&#039;http://doctor.thedoctor.com/doctor&#039;)
 *   .assert.enabled(&#039;#onmars&#039;, &#039;Is enabled!&#039;)
 *   .done();
 * ```
 *
 * @api
 * @method enabled
 * @param {string} selector Selector that matches the elements to test
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.enabled = function (selector, message) {
  var hash = uuid.v4();

  if (this.test.querying === true) {
    message = selector;
    selector = this.test.selector;
  }

  var cb = this._generateCallbackAssertion(&#039;enabled&#039;, &#039;enabled&#039;, this._testShallowEquals, hash, {expected: true, selector: selector, message: message}).bind(this.test);
  this._addToActionQueue([selector, true, hash], &#039;enabled&#039;, cb);
  return this.chaining ? this : this.test;
};

/**
 * Determine if an element is currently disabled.
 *
 * ```html
 * &lt;input disabled id=&quot;onearth&quot; type=&quot;text&quot; size=&quot;50&quot; name=&quot;onearth&quot; placeholder=&quot;State your name, rank and intention!&quot;&gt;&lt;/input&gt;
 * ```
 *
 * ```javascript
 * test
 *   .open(&#039;http://doctor.thedoctor.com/doctor&#039;)
 *   .assert.disabled(&#039;#onearth&#039;, &#039;Is disabled!&#039;)
 *   .done();
 * ```
 *
 * @api
 * @method disabled
 * @param {string} selector Selector that matches the elements to test
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.disabled = function (selector, message) {
  var hash = uuid.v4();

  if (this.test.querying === true) {
    message = selector;
    selector = this.test.selector;
  }

  var cb = this._generateCallbackAssertion(&#039;enabled&#039;, &#039;enabled&#039;, this._testShallowEquals, hash, {expected: false, selector: selector, message: message}).bind(this.test);
  this._addToActionQueue([selector, false, hash], &#039;enabled&#039;, cb);
  return this.chaining ? this : this.test;
};

/**
 * Checks the contents of a cookie.
 *
 * ```javascript
 *  test
 *    .open(&#039;http://cookiejar.io/not_your_mothers_javascript.html&#039;)
 *    .setCookie(&#039;atestcookie&#039;, &#039;foobar=baz&#039;)
 *    .assert.cookie(&#039;atestcookie&#039;, &#039;foobar=baz&#039;)
 *    .done();
 * ```
 *
 * @api
 * @method cookie
 * @param {string} name Name of the cookie
 * @param {string} expect Expected testresult
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.cookie = function (name, expected, message) {
  var hash = uuid.v4();
  var cb = this._generateCallbackAssertion(&#039;cookie&#039;, &#039;cookie&#039;, this._testShallowEquals, hash, {expected: expected, name: name, message: message}).bind(this.test);
  this._addToActionQueue([name, expected, hash], &#039;cookie&#039;, cb);
  return this.chaining ? this : this.test;
};

/**
 * Asserts that current HTTP status code is the same as the one passed as argument.
 * TODO: Needs some work to be implement (maybe JavaScript, Webdriver ha no method for this)
 *
 * @method httpStatus
 * @param {integer} status HTTP status code
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.httpStatus = function (status, message) {
  var hash = uuid.v4();
  var cb = this._generateCallbackAssertion(&#039;httpStatus&#039;, &#039;httpStatus&#039;, this._testShallowEquals, hash, {expected: status, message: message}).bind(this.test);
  this._addToActionQueue([status, hash], &#039;httpStatus&#039;, cb);
  return this.chaining ? this : this.test;
};

/**
 * Asserts that an element matching the provided selector expression exists in remote DOM environment.
 *
 * ```html
 * &lt;body&gt;
 *   &lt;p id=&quot;so-lonely&quot;&gt;Last of the timelords&lt;/p&gt;
 * &lt;/body&gt;
 * ```
 *
 * ```javascript
 * test
 *   .open(&#039;http://doctor.thedoctor.com/doctor&#039;)
 *   .assert.exists(&#039;#so-lonely&#039;, &#039;The loneliest element in the universe exists&#039;)
 *   .done()
 * ```
 *
 * @api
 * @method exists
 * @param {string} selector Selector that matches the elements to test
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.exists = function (selector, message) {
  var hash = uuid.v4();

  if (this.test.querying === true) {
    message = selector;
    selector = this.test.selector;
  }

  var cb = this._generateCallbackAssertion(&#039;exists&#039;, &#039;exists&#039;, this._testTruthy, hash, {selector: selector, message: message}).bind(this.test);
  this._addToActionQueue([selector, hash], &#039;exists&#039;, cb);
  return this.chaining ? this : this.test;
};

/**
 * Asserts that an element matching the provided selector expression doesnʼt
 * exists within the remote DOM environment.
 *
 * ```html
 * &lt;body&gt;
 *   &lt;p id=&quot;so-lonely&quot;&gt;Last of the time lords&lt;/p&gt;
 * &lt;/body&gt;
 * ```
 *
 * ```javascript
 * test
 *   .open(&#039;http://doctor.thedoctor.com/doctor&#039;)
 *   .assert.doesntExist(&#039;#the-master&#039;, &#039;The master element has not been seen&#039;)
 *   .done();
 * ```
 *
 * @api
 * @method doesntExist
 * @param {string} selector Selector that matches the elements to test
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.doesntExist = function (selector, message) {
  var hash = uuid.v4();

  if (this.test.querying === true) {
    message = selector;
    selector = this.test.selector;
  }

  var cb = this._generateCallbackAssertion(&#039;exists&#039;, &#039;!exists&#039;, this._testFalsy, hash, {selector: selector, message: message}).bind(this.test);
  this._addToActionQueue([selector, hash], &#039;exists&#039;, cb);
  return this.chaining ? this : this.test;
};

/**
 * Asserts that the element matching the provided selector expression is not visible.
 *
 * ```html
 * &lt;body&gt;
 *   &lt;h1 style=&quot;display: none&quot;&gt;Me? So hidden …&lt;/h1&gt;
 *   &lt;h2&gt;Me? So in viewport...&lt;/h2&gt;
 * &lt;/body&gt;
 * ```
 *
 * ```javascript
 *  test
 *    .open(&#039;http://allyourviewportsbelongto.us&#039;)
 *    .assert.notVisible(&#039;h1&#039;, &#039;Element is not visible&#039;)
 *    .done();
 * ```
 *
 *
 * &gt; NOTE: Buggy on all browsers
 * 
 * @api
 * @method notVisible
 * @param {string} selector Selector that matches the elements to test
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.notVisible = function (selector, message) {
  var hash = uuid.v4();

  if (this.test.querying === true) {
    message = selector;
    selector = this.test.selector;
  }

  var cb = this._generateCallbackAssertion(&#039;visible&#039;, &#039;!visible&#039;, this._testFalsy, hash, {selector: selector, message: message}).bind(this.test);
  this._addToActionQueue([selector, hash], &#039;visible&#039;, cb);
  return this.chaining ? this : this.test;
};

/**
 * Asserts that the element matching the provided selector expression is visible.
 *
 * ```html
 * &lt;body&gt;
 *   &lt;h1&gt;Me? So in viewport …&lt;/h1&gt;
 * &lt;/body&gt;
 * ```
 *
 * ```javascript
 *  test
 *    .open(&#039;http://allyourviewportsbelongto.us&#039;)
 *    .assert.visible(&#039;h1&#039;, &#039;Element is visible&#039;)
 *    .done();
 * ```
 *
 * &gt; NOTE: Buggy on all browsers
 * 
 * @api
 * @method visible
 * @param {string} selector Selector that matches the elements to test
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.visible = function (selector, message) {
  var hash = uuid.v4();

  if (this.test.querying === true) {
    message = selector;
    selector = this.test.selector;
  }

  var cb = this._generateCallbackAssertion(&#039;visible&#039;, &#039;visible&#039;, this._testTruthy, hash, {selector: selector, message: message}).bind(this.test);
  this._addToActionQueue([selector, hash], &#039;visible&#039;, cb);
  return this.chaining ? this : this.test;
};

/**
 * Asserts that given text does not exist in the provided selector.
 *
 * ```html
 * &lt;body&gt;
 *   &lt;h1&gt;This is a CasperJS sandbox&lt;/h1&gt;
 * &lt;/body&gt;
 * ```
 *
 * ```javascript
 *  test
 *    .open(&#039;http://dalekjs.com/guineapig/&#039;)
 *    .assert.doesntHaveText(&#039;h1&#039;, &#039;This page is a Dalek sandbox&#039;, &#039;It´s a sandbox!&#039;)
 *    .done();
 * ```
 * 
 * @api
 * @method doesntHaveText
 * @param {string} selector Selector that matches the elements to test
 * @param {string} expected Expected test result
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.doesntHaveText = function (selector, expected, message) {
  var hash = uuid.v4();
  if (this.test.querying === true) {
    message = expected;
    expected = selector;
    selector = this.test.selector;
  }

  var cb = this._generateCallbackAssertion(&#039;text&#039;, &#039;!text&#039;, this._testShallowUnequals, hash, {selector: selector, expected: expected, message: message}).bind(this.test);
  this._addToActionQueue([selector, expected, hash], &#039;text&#039;, cb);
  return this.chaining ? this : this.test;
};

/**
 * Asserts that given text does not exist in the current alert/prompt/confirm dialog.
 *
 * ```html
 * &lt;a href=&quot;#&quot; id=&quot;alert_confirm&quot; onclick=&quot;confirm(&#039;Confirm me!&#039;)&quot;&gt;I make confirm&lt;/a&gt;
 * ```
 *
 * ```javascript
 *  test
 *    .open(&#039;http://skaaro.com/index.html&#039;)
 *    .click(&#039;#alert_confirm&#039;)
 *    .assert.dialogDoesntHaveText(&#039;I am an alert&#039;)
 *    .accept()
 *    .done();
 * ```
 *
 * &gt; NOTE: Does not work in Firefox &amp; PhantomJS
 * 
 * @api
 * @method dialogDoesntHaveText
 * @param {string} expected Expected test result
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.dialogDoesntHaveText = function (expected, message) {
  var hash = uuid.v4();
  var cb = this._generateCallbackAssertion(&#039;alertText&#039;, &#039;!alertText&#039;, this._testShallowUnequals, hash, {expected: expected, message: message}).bind(this.test);
  this._addToActionQueue([expected, hash], &#039;alertText&#039;, cb);
  return this.chaining ? this : this.test;
};

/**
 * Asserts that given text does exist in the provided selector.
 *
 * ```html
 * &lt;body&gt;
 *   &lt;h1&gt;This is a Dalek sandbox&lt;/h1&gt;
 * &lt;/body&gt;
 * ```
 *
 * ```javascript
 *  test
 *    .open(&#039;http://dalekjs.com/guineapig/&#039;)
 *    .assert.text(&#039;h1&#039;, &#039;This page is a Dalek sandbox&#039;, &#039;Exterminate!&#039;)
 *    .done();
 * ```
 *
 * of course, text works also with the assertion helpers is() and not()
 *
 * ```javascript
 *  test
 *    .open(&#039;http://dalekjs.com/guineapig/&#039;)
 *    .assert.text(&#039;h1&#039;).is(&#039;This page is a Dalek sandbox&#039;, &#039;Exterminate!&#039;)
 *    .done();
 * ```
 *
 * ```javascript
 *  test
 *    .open(&#039;http://dalekjs.com/guineapig/&#039;)
 *    .assert.text(&#039;h1&#039;).is.not(&#039;This page is a CasperJS sandbox&#039;, &#039;Exterminate!&#039;)
 *    .done();
 * ```
 *
 * @api
 * @method text
 * @param {string} selector Selector that matches the elements to test
 * @param {string} expected Expected test result
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.text = function (selector, expected, message) {
  var hash = uuid.v4();
  if (this.test.querying === true) {
    message = expected;
    expected = selector;
    selector = this.test.selector;
  }

  var cb = this._generateCallbackAssertion(&#039;text&#039;, &#039;text&#039;, this._testShallowEquals, hash, {selector: selector, expected: expected, message: message}).bind(this.test);
  this._addToActionQueue([selector, expected, hash], &#039;text&#039;, cb);
  return (this.chaining || this.test.querying) ? this : this.test;
};

/**
 * Asserts that given alertText does exist in the provided alert/confirm or prompt dialog.
 *
 * ```html
 * &lt;a href=&quot;#&quot; id=&quot;alert&quot; onclick=&quot;alert(&#039;I am an alert&#039;)&quot;&gt;I make alerts!&lt;/a&gt;
 * ```
 *
 * ```javascript
 *  test
 *    .open(&#039;http://skaaro.com/index.html&#039;)
 *    .click(&#039;#alert_confirm&#039;)
 *    .assert.dialogText(&#039;I am an alert&#039;)
 *    .accept()
 *    .done();
 * ```
 *
 * of course, text works also with the assertion helpers is() and not()
 *
 * ```javascript
 *  test
 *    .open(&#039;http://dalekjs.com/guineapig/&#039;)
 *    .assert.dialogText().is(&#039;I am an alert&#039;, &#039;Exterminate!&#039;)
 *    .done();
 * ```
 *
 * ```javascript
 *  test
 *    .open(&#039;http://dalekjs.com/guineapig/&#039;)
 *    .assert.dialogText().is.not(&#039;I am an prompt&#039;, &#039;Exterminate!&#039;)
 *    .done();
 * ```
 *
 *
 * &gt; NOTE: Does not work in Firefox &amp; PhantomJS
 * 
 * @api
 * @method dialogText
 * @param {string} expected Expected testresult
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.dialogText = function (expected, message) {
  var hash = uuid.v4();
  var cb = this._generateCallbackAssertion(&#039;alertText&#039;, &#039;alertText&#039;, this._testShallowEquals, hash, {expected: expected, message: message}).bind(this.test);
  this._addToActionQueue([expected, hash], &#039;alertText&#039;, cb);
  return (this.chaining || this.test.querying) ? this : this.test;
};

/**
 * Asserts that the page title is as expected.
 *
 * ```javascript
 *   test.open(&#039;http://doctorwhotv.co.uk/&#039;)
 *     .assert.title(&#039;Doctor Who TV&#039;, &#039;Not your Daleks TV&#039;)
 *     .done();
 * ```
 *
 * Yep, using assertion helpers is also possible:
 *
 * ```javascript
 *   test.open(&#039;http://doctorwhotv.co.uk/&#039;)
 *     .assert.title().is(&#039;Doctor Who TV&#039;, &#039;Not your Daleks TV&#039;)
 *     .done();
 * ```
 *
 * and the not() helper is available too:
 *
 * ```javascript
 *   test.open(&#039;http://doctorwhotv.co.uk/&#039;)
 *     .assert.title().is.not(&#039;Dalek Emperor TV&#039;, &#039;Not your Daleks TV&#039;)
 *     .done();
 * ```
 *
 * @api
 * @method title
 * @param {string} expected Expected test result
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.title = function (expected, message) {
  var hash = uuid.v4();
  var cb = this._generateCallbackAssertion(&#039;title&#039;, &#039;title&#039;, this._testShallowEquals, hash, {expected: expected, message: message}).bind(this.test);
  this._addToActionQueue([expected, hash], &#039;title&#039;, cb);
  return this.chaining ? this : this.test;
};

/**
 * Asserts that given title does not match the given expectations.
 *
 * ```javascript
 *   test.open(&#039;http://doctorwhotv.co.uk/&#039;)
 *     .assert.doesntHaveTitle(&#039;Dalek Emperor TV&#039;, &#039;Not your Daleks TV&#039;)
 *     .done();
 * ```
 *
 * @api
 * @method doesntHaveTitle
 * @param {string} expected Expected test result
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.doesntHaveTitle = function (expected, message) {
  var hash = uuid.v4();
  var cb = this._generateCallbackAssertion(&#039;title&#039;, &#039;!title&#039;, this._testShallowUnequals, hash, {expected: expected, message: message}).bind(this.test);
  this._addToActionQueue([expected, hash], &#039;title&#039;, cb);
  return this.chaining ? this : this.test;
};

/**
 * Asserts that the pages url is as expected.
 *
 * ```javascript
 *   test.open(&#039;http://doctorwhotv.co.uk/&#039;)
 *     .assert.url(&#039;http://doctorwhotv.co.uk/&#039;, &#039;URL is as expected&#039;)
 *     .done();
 * ```
 *
 * You can also check if the protocol changed,
 * nice to see when you open GitHub with &#039;http&#039; instead of &#039;https&#039;
 *
 * ```javascript
 *   test.open(&#039;http://github.com&#039;)
 *     .assert.url(&#039;https://github.com/&#039;, &#039;Changed prototcols&#039;)
 *     .done();
 * ```
 *
 * Yep, using assertion helpers is also possible:
 *
 * ```javascript
 *   test.open(&#039;http://github.com&#039;)
 *     .assert.url().is(&#039;http://doctorwhotv.co.uk/&#039;, &#039;URL is as expected&#039;)
 *     .done();
 * ```
 *
 * and the not() helper is available too:
 *
 * ```javascript
 *   test.open(&#039;http://doctorwhotv.co.uk/&#039;)
 *     .assert.url().is.not(&#039;http://doctorwhotv.co.uk/&#039;, &#039;URL is as expected&#039;)
 *     .done();
 * ```
 *
 * @api
 * @method url
 * @param {string} expected Expected test result
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.url = function (expected, message) {
  var hash = uuid.v4();
  var cb = this._generateCallbackAssertion(&#039;url&#039;, &#039;url&#039;, this._testShallowEquals, hash, {expected: expected, message: message}).bind(this.test);
  this._addToActionQueue([expected, hash], &#039;url&#039;, cb);
  return this.chaining ? this : this.test;
};

/**
 * Asserts that the pages URL does not match the expectation.
 *
 * ```javascript
 *   test.open(&#039;http://doctorwhotv.co.uk/&#039;)
 *     .assert.doesntHaveUrl(&#039;http://doctorwhotv.co.uk/&#039;, &#039;URL is not expected&#039;)
 *     .done();
 * ```
 *
 * @api
 * @method doesntHaveUrl
 * @param {string} expected Expected test result
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.doesntHaveUrl = function (expected, message) {
  var hash = uuid.v4();
  var cb = this._generateCallbackAssertion(&#039;url&#039;, &#039;!url&#039;, this._testShallowUnequals, hash, {expected: expected, message: message}).bind(this.test);
  this._addToActionQueue([expected, hash], &#039;url&#039;, cb);
  return this.chaining ? this : this.test;
};

/**
 * Asserts that an elements attribute is as expected.
 *
 * ```html
 * &lt;form&gt;
 *   &lt;button class=&quot;jumpButton&quot; type=&quot;submit&quot;&gt;Fire&lt;/button&gt;
 * &lt;/form&gt;
 * ```
 *
 * ```javascript
 *  test
 *    .open(&#039;http://dalekjs.com/guineapig/&#039;)
 *    .assert.attr(&#039;.jumpButton&#039;, &#039;type&#039;, &#039;submit&#039;)
 *    .done();
 * ```
 *
 * ```html
 * &lt;div id=&quot;dataDiv&quot; data-spot=&quot;cat&quot;&gt;&lt;/div&gt;
 * ```
 *
 * ```javascript
 *  test
 *    .open(&#039;http://dalekjs.com/guineapig/&#039;)
 *    .assert.attr(&#039;#dataDiv&#039;).is(&#039;data-spot&#039;, &#039;cat&#039;, &#039;We found Dataʼs cat!&#039;)
 *    .done();
 * ```
 *
 * ```javascript
 *  test
 *    .open(&#039;http://dalekjs.com/guineapig/&#039;)
 *    .assert.attr(&#039;#dataDiv&#039;).is.not(&#039;data-spot&#039;, &#039;doc&#039;, &#039;Spot is not a dog!&#039;)
 *    .done();
 * ```
 *
 * @api
 * @method attr
 * @param {string} selector Selector that matches the elements to test
 * @param {string} attribute The attribute to test
 * @param {string} expected Expected test result
 * @param {string} message Message for the test reporter
 * @chainable
 */

Assertions.prototype.attr = function (selector, attribute, expected, message) {
  var hash = uuid.v4();

  if (this.test.querying === true) {
    message = expected;
    expected = attribute;
    attribute = selector;
    selector = this.test.selector;
  }

  var cb = this._generateCallbackAssertion(&#039;attribute&#039;, &#039;attribute&#039;, this._testShallowEquals, hash, {expected: expected, message: message, selector: selector, attribute: attribute}).bind(this.test);
  this._addToActionQueue([selector, attribute, expected, hash], &#039;attribute&#039;, cb);
  return this.chaining ? this : this.test;
};

// TEST HELPER
// -----------

/**
 * Is helper
 *
 * @method is
 * @param {mixed} expected Value to check
 * @param {string} message Test message
 * @chainable
 */

Assertions.prototype.is = function (expected, message) {
  return this.generateTestHelper(&#039;is&#039;, &#039;_testShallowEquals&#039;, false)(expected, message);
};

/**
 * Not helper
 *
 * @method not
 * @param {mixed} expected Value to check
 * @param {string} message Test message
 * @chainable
 */

Assertions.prototype.not = function (expected, message) {
  return this.generateTestHelper(&#039;not&#039;, &#039;_testShallowEquals&#039;, true)(expected, message);
};

/**
 * Between helper
 *
 * @method between
 * @param {mixed} expected Value to check
 * @param {string} message Test message
 * @chainable
 */

Assertions.prototype.between = function (expected, message) {
  return this.generateTestHelper(&#039;between&#039;, &#039;_testBetween&#039;, false)(expected, message);
};

/**
 * Gt helper
 *
 * @method gt
 * @param {mixed} expected Value to check
 * @param {string} message Test message
 * @chainable
 */

Assertions.prototype.gt = function (expected, message) {
  return this.generateTestHelper(&#039;gt&#039;, &#039;_testGreaterThan&#039;, false)(expected, message);
};

/**
 * Gte helper
 *
 * @method gte
 * @param {mixed} expected Value to check
 * @param {string} message Test message
 * @chainable
 */

Assertions.prototype.gte = function (expected, message) {
  return this.generateTestHelper(&#039;gte&#039;, &#039;_testGreaterThanEqual&#039;, false)(expected, message);
};

/**
 * Lt helper
 *
 * @method lt
 * @param {mixed} expected Value to check
 * @param {string} message Test message
 * @chainable
 */

Assertions.prototype.lt = function (expected, message) {
  return this.generateTestHelper(&#039;lt&#039;, &#039;_testLowerThan&#039;, false)(expected, message);
};

/**
 * Lte helper
 *
 * @method lte
 * @param {mixed} expected Value to check
 * @param {string} message Test message
 * @chainable
 */

Assertions.prototype.lte = function (expected, message) {
  return this.generateTestHelper(&#039;lte&#039;, &#039;_testLowerThanEqual&#039;, false)(expected, message);
};

/**
 * Contain helper
 *
 * @method contain
 * @param {mixed} expected Value to check
 * @param {string} message Test message
 * @chainable
 */

Assertions.prototype.contain = function (expected, message) {
  return this.generateTestHelper(&#039;contain&#039;, &#039;_contain&#039;, false)(expected, message);
};

/**
 * Match helper
 *
 * @method match
 * @param {string} expected Regex to match on
 * @param {string} message Test message
 * @chainable
 */

Assertions.prototype.match = function (expected, message) {
  return this.generateTestHelper(&#039;match&#039;, &#039;_match&#039;, false)(expected, message);
};

/**
 * Equals case insensitive helper
 *
 * @method equalsCaseInsensitive
 * @param {mixed} expected Value to check
 * @param {string} message Test message
 * @chainable
 */

Assertions.prototype.equalsCaseInsensitive = function (expected, message) {
  return this.generateTestHelper(&#039;equalsCaseInsensitive&#039;, &#039;_caseInsensitiveMatch&#039;, false)(expected, message);
};

// HELPER METHODS
// --------------

/**
 * Generates a callback that will be fired when the action has been completed.
 * The callback itself will then validate the answer and will also emit an event
 * that the action has been successfully executed.
 *
 * @method _generateCallbackAssertion
 * @param {string} key Unique key of the action
 * @param {string} type Type of the action (usually the actions name)
 * @return {function} The generated callback function
 * @private
 */

Assertions.prototype._generateCallbackAssertion = function (key, type, test, hash, opts) {
  var cb = function (data) {
    if (data &amp;&amp; data.key === key &amp;&amp; data.hash === hash) {

      this._lastGeneratedAction = {key: key, type: type, test: test, hash: hash, opts: opts, data: data};

      if (!opts.expected &amp;&amp; (key === &#039;title&#039; || key === &#039;width&#039; || key === &#039;height&#039; || key === &#039;url&#039; || key === &#039;text&#039; || key === &#039;attribute&#039; || key === &#039;numberOfElements&#039; || key === &#039;numberOfVisibleElements&#039;)) {
        return false;
      }

      if (typeof opts.expected === &#039;function&#039;) {
        opts.expected = opts.expected();
      }

      var testResult = test(data.value, opts.expected);

      this.reporter.emit(&#039;report:assertion&#039;, {
        success: testResult,
        expected: opts.expected,
        value: data.value,
        message: opts.message,
        type: type
      });

      this.incrementExpectations();
      if (!testResult) {
        this.incrementFailedAssertions();
      }
    }
  };
  return cb;
};

/**
 * Adds a method to the queue of actions/assertions to execute
 *
 * @method _addToActionQueue
 * @param {object} opts Options of the action to invoke
 * @param {string} driverMethod Name of the method to call on the driver
 * @param {function} A callback function that will be executed when the action has been executed
 * @private
 * @chainable
 */

Assertions.prototype._addToActionQueue = function (opts, driverMethod, cb) {
  this._lastGeneratedShit = {opts: opts, driverMethod: driverMethod};
  this.test.actionPromiseQueue.push(function () {
    var deferredAction = Q.defer();
    this.test.driver[driverMethod].apply(this.test.driver, opts);
    deferredAction.resolve();
    this.test.driver.events.on(&#039;driver:message&#039;, cb);
    return deferredAction.promise;
  }.bind(this));
  return this;
};

/**
 * Generates a function that can be used
 *
 * @method generateTestHelper
 * @param name
 * @param assertionFn
 * @param negate
 * @return
 * @private
 */

Assertions.prototype.generateTestHelper = function (name, assertionFn, negate) {
  return function (expected, message) {
    var gen = this._lastGeneratedShit;

    this.test.actionPromiseQueue.push(function () {
      var deferredAction = Q.defer();
      deferredAction.resolve();
      this.test.driver.events.on(&#039;driver:message&#039;, function () {

        if (gen.opts &amp;&amp; gen.opts[(gen.opts.length - 1)] &amp;&amp; this.test._lastGeneratedAction &amp;&amp; this.test._lastGeneratedAction.hash) {
          if (gen.opts[(gen.opts.length - 1)] === this.test._lastGeneratedAction.hash &amp;&amp; !this.proceeded[this.test._lastGeneratedAction.hash + name]) {
            var testResult = this[assertionFn](expected, this.test._lastGeneratedAction.data.value);

            if (negate) {
              testResult = !testResult;
            }

            this.proceeded[this.test._lastGeneratedAction.hash + name] = true;

            this.test.reporter.emit(&#039;report:assertion&#039;, {
              success: testResult,
              expected: expected,
              value: this.test._lastGeneratedAction.data.value,
              message: message,
              type: this.test._lastGeneratedAction.type
            });

            this.test.incrementExpectations();

            if (!testResult) {
              this.test.incrementFailedAssertions();
            }
          }
        }
      }.bind(this));
      return deferredAction.promise;
    }.bind(this));

    return this.chaining ? this : this.test;
  }.bind(this);
};

// ASSERT METHODS
// --------------

/**
 * Assert if a given value shallow equals a second given value
 *
 * @method _testShallowEquals
 * @param {mixed} a Value to test
 * @param {mixed} b Value to test
 * @return {bool} false if values donʼt match, true if they match
 * @private
 */

Assertions.prototype._testShallowEquals = function (a, b) {
  try {
    chai.assert.equal(a, b);
  } catch (e) {
    return false;
  }

  return true;
};

/**
 * Assert if a given value shallow does not equal a second given value
 *
 * @method _testShallowUnequals
 * @param {mixed} a Value to test
 * @param {mixed} b Value to test
 * @return {bool} true if values donʼt match, false if they match
 * @private
 */

Assertions.prototype._testShallowUnequals = function (a, b) {
  try {
    chai.assert.notEqual(a, b);
  } catch (e) {
    return false;
  }

  return true;
};

/**
 * Assert if a given value matches a range
 *
 * @method _testBetween
 * @param {array} a Range to test
 * @param {bool} b Value to compare
 * @return {bool} test result
 * @private
 */

Assertions.prototype._testBetween = function (a, b) {
  try {
    chai.expect(b).to.be.within(a[0], a[1]);
  } catch (e) {
    return false;
  }

  return true;
};

/**
 * Assert if a given value is greater than the value to compare
 *
 * @method _testGreaterThan
 * @param {bool} a Value to test
 * @param {bool} b Value to compare
 * @return {bool} test result
 * @private
 */

Assertions.prototype._testGreaterThan = function (a, b) {
  try {
    chai.expect(b).to.be.above(a);
  } catch (e) {
    return false;
  }

  return true;
};

/**
 * Assert if a given value is greater or equal than the value to compare
 *
 * @method _testGreaterThanEqual
 * @param {bool} a Value to test
 * @param {bool} b Value to compare
 * @return {bool} test result
 * @private
 */

Assertions.prototype._testGreaterThanEqual = function (a, b) {
  return this._testGreaterThan(a - 1, b);
};

/**
 * Assert if a given value is lower than the value to compare
 *
 * @method _testLowerThan
 * @param {bool} a Value to test
 * @param {bool} b Value to compare
 * @return {bool} test result
 * @private
 */

Assertions.prototype._testLowerThan = function (a, b) {
  try {
    chai.expect(b).to.be.below(a);
  } catch (e) {
    return false;
  }

  return true;
};

/**
 * Asserts that 2 string match regardless of case
 *
 * @method _caseInsensitiveMatch
 * @param {string} a Value to test
 * @param {string} b Value to compare
 * @return {bool} testresult
 * @private
 */

Assertions.prototype._caseInsensitiveMatch = function (a, b) {
  try {
    if(a.toLowerCase &amp;&amp; b.toLowerCase) {
      chai.expect(b.toLowerCase()).to.eql(a.toLowerCase());
    } else {
      return false;
    }
  } catch (e) {
    return false;
  }

  return true;
};

/**
 * Assert if a given value contain another value
 *
 * @method _contain
 * @param {bool} a Value to test
 * @param {bool} b Value to compare
 * @return {bool} test result
 * @private
 */

Assertions.prototype._contain = function (a, b) {
  try {
    chai.expect(b).to.include(a);
  } catch (e) {
    return false;
  }

  return true;
};

/**
 * Assert if a given value is lower or equal than the value to compare
 *
 * @method _testLowerThanEqual
 * @param {bool} a Value to test
 * @param {bool} b Value to compare
 * @return {bool} test result
 * @private
 */

Assertions.prototype._testLowerThanEqual = function (a, b) {
  return this._testLowerThan(a + 1, b);
};

/**
 * Assert if a given value is boolean &#039;true&#039;
 *
 * @method _testTruthy
 * @param {bool} a Value to test
 * @return {bool} false if value is false, true if value is true
 * @private
 */

Assertions.prototype._testTruthy = function (a) {
  return a === &#039;true&#039; || a === true;
};

/**
 * Assert if a given value is boolean &#039;false&#039;
 *
 * @method _testFalsy
 * @param {bool} a Value to test
 * @return {bool} true if value is false, false if value is true
 * @private
 */

Assertions.prototype._testFalsy = function (a) {
  return a === &#039;false&#039; || a === false;
};

/**
 * Assert a given value matches a RegEx
 *
 * @method _contain
 * @param {mixed} a Value to test
 * @param {string} b Value to compare
 * @return {bool} test result
 * @private
 */

Assertions.prototype._match = function (a, b) {
  try {
    chai.expect(b).to.match(a);
  } catch (e) {
    return false;
  }

  return true;
};</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
